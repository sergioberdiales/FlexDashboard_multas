geom_bar()
num_multas_por_calificacion
num_multas_por_ano_data <- data %>% group_by("Año" = year(date_time)) %>% summarise(Numero_Multas_Anual = sum(IMPORTE, na.rm = TRUE))
num_multas_por_ano <- ggplot(data = num_multas_por_ano_data, aes(y = Numero_Multas_Anual , x = Año, group=1)) +
geom_line() +
ylim(0, 10000000)
num_multas_por_ano
ggplot(data) +
stat_summary(aes(x = year(date_time), y = IMPORTE),
fun.y = sum,
geom = "line",
group = 1) +
ylim(0, 10000000)
importe_multas_por_ano_data <- data %>% group_by("Año" = year(date_time)) %>% summarise(Importe_Total_Anual = sum(IMPORTE, na.rm = TRUE))
importe_multas_por_ano <- ggplot(data = importe_multas_por_ano_data, aes(y = Importe_Total_Anual , x = Año, group=1)) +
geom_line() +
ylim(0, 10000000)
importe_multas_por_ano
multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, TIPO, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = TIPO, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity')
multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, CALIFICACION) %>%
summarize(`Importe multas (€)` = sum(IMPORTE, na.rm=TRUE)) %>%
ggplot(aes(x = Año, y = `Importe multas (€)`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity')
multas %>%
mutate(Año = year(date_time)) %>%
group_by(CALIFICACION, TIPO, IMPORTE) %>%
summarize(`Importe multas (€)` = sum(IMPORTE, na.rm=TRUE)) %>%
ggplot(aes(x = TIPO, y = `Importe multas (€)`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity')
multas %>%
mutate(Año = year(date_time)) %>%
group_by(CALIFICACION, TIPO, IMPORTE) %>%
summarize(`Importe multas (€)` = sum(IMPORTE, na.rm=TRUE)) %>%
ggplot(aes(x = TIPO, y = `Importe multas (€)`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity')
multas %>%
mutate(Año = year(date_time)) %>%
group_by(CALIFICACION, TIPO) %>%
summarize(`Importe multas (€)` = sum(IMPORTE, na.rm=TRUE)) %>%
ggplot(aes(x = TIPO, y = `Importe multas (€)`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity')
multas %>%
group_by(CALIFICACION, IMPORTE) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = IMPORTE, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity')
multas %>%
group_by(CALIFICACION, as.factor(IMPORTE)) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = IMPORTE, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity')
multas %>%
mutate(IMPORTE = as.factor(IMPORTE)) %>%
group_by(CALIFICACION, IMPORTE) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = IMPORTE, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity')
View(data)
multas %>%
mutate(Mes = month(date_time)) %>%
group_by(Mes, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = Mes, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity')
multas %>%
mutate(Mes = as.factor(month(date_time))) %>%
group_by(Mes, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = Mes, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity')
library(plotly)
install.packages("plotly")
library(plotly)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = Año, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, TIPO, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = TIPO, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, TIPO, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = TIPO, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(TIPO, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = TIPO, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(TIPO, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = TIPO, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity') +
theme(legend.position="bottom")
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(TIPO, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = TIPO, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw(legend.position="bottom") +
geom_bar(stat = 'identity')
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(TIPO, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = TIPO, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.position="bottom") +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, CALIFICACION) %>%
summarize(`Importe multas (€)` = sum(IMPORTE, na.rm=TRUE)) %>%
ggplot(aes(x = Año, y = `Importe multas (€)`, fill = CALIFICACION)) +
theme_bw() +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = Año, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.position = "none") +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = Año, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = Año, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
legend.position = "bottom") +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = Año, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, CALIFICACION) %>%
summarize(`Importe multas (€)` = sum(IMPORTE, na.rm=TRUE)) %>%
ggplot(aes(x = Año, y = `Importe multas (€)`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(TIPO, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = TIPO, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(CALIFICACION, TIPO) %>%
summarize(`Importe multas (€)` = sum(IMPORTE, na.rm=TRUE)) %>%
ggplot(aes(x = TIPO, y = `Importe multas (€)`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Mes = as.factor(month(date_time))) %>%
group_by(Mes, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = Mes, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(IMPORTE = as.factor(IMPORTE)) %>%
group_by(CALIFICACION, IMPORTE) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = IMPORTE, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity')
ggplotly(p)
summary(as.factor(data$IMPORTE))
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(TIPO, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = TIPO, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(CALIFICACION, TIPO) %>%
summarize(`Importe multas (€)` = sum(IMPORTE, na.rm=TRUE)) %>%
ggplot(aes(x = TIPO, y = `Importe multas (€)`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(IMPORTE = as.factor(IMPORTE)) %>%
group_by(CALIFICACION, IMPORTE) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = IMPORTE, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(IMPORTE = as.factor(IMPORTE)) %>%
group_by(CALIFICACION, IMPORTE) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = IMPORTE, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_bar(stat = 'identity') +
geom_text(aes(label=len), vjust=-0.3, size=3.5)
ggplotly(p)
p <- multas %>%
mutate(IMPORTE = as.factor(IMPORTE)) %>%
group_by(CALIFICACION, IMPORTE) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = IMPORTE, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_bar(stat = 'identity') +
geom_text(aes(label=`Número de multas`), vjust=-0.3, size=3.5)
ggplotly(p)
p <- multas %>%
mutate(IMPORTE = as.factor(IMPORTE)) %>%
group_by(CALIFICACION, IMPORTE) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = IMPORTE, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(TIPO, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = TIPO, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x=element_text(size=rel(0.5)) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(TIPO, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = TIPO, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x=element_text(size=rel(0.5))) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(TIPO, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = TIPO, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x=element_text(size=rel(0.8))) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(CALIFICACION, TIPO) %>%
summarize(`Importe multas (€)` = sum(IMPORTE, na.rm=TRUE)) %>%
ggplot(aes(x = TIPO, y = `Importe multas (€)`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x=element_text(size=rel(0.8))) +
geom_bar(stat = 'identity')
ggplotly(p)
library(flexdashboard)
library(readr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(plotly)
multas <- read_csv('data_multas.csv')
multas <- multas %>% mutate(fct_relevel(CALIFICACION, c("Leve", "Grave", "Muy Grave")))
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = Año, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, CALIFICACION) %>%
summarize(`Importe multas (€)` = sum(IMPORTE, na.rm=TRUE)) %>%
ggplot(aes(x = Año, y = `Importe multas (€)`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(TIPO, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = TIPO, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x=element_text(size=rel(0.8))) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(CALIFICACION, TIPO) %>%
summarize(`Importe multas (€)` = sum(IMPORTE, na.rm=TRUE)) %>%
ggplot(aes(x = TIPO, y = `Importe multas (€)`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x=element_text(size=rel(0.8))) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Mes = as.factor(month(date_time))) %>%
group_by(Mes, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = Mes, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(IMPORTE = as.factor(IMPORTE)) %>%
group_by(CALIFICACION, IMPORTE) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = IMPORTE, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_bar(stat = 'identity')
ggplotly(p)
glimpse(multas)
library(flexdashboard)
library(readr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(plotly)
multas <- read_csv('data_multas.csv')
multas <- multas %>% mutate(CALIFICACION = fct_relevel(CALIFICACION, c("Leve", "Grave", "Muy Grave")))
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = Año, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, CALIFICACION) %>%
summarize(`Importe multas (€)` = sum(IMPORTE, na.rm=TRUE)) %>%
ggplot(aes(x = Año, y = `Importe multas (€)`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(TIPO, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = TIPO, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x=element_text(size=rel(0.8))) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(CALIFICACION, TIPO) %>%
summarize(`Importe multas (€)` = sum(IMPORTE, na.rm=TRUE)) %>%
ggplot(aes(x = TIPO, y = `Importe multas (€)`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x=element_text(size=rel(0.8))) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(Mes = as.factor(month(date_time))) %>%
group_by(Mes, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = Mes, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity')
ggplotly(p)
p <- multas %>%
mutate(IMPORTE = as.factor(IMPORTE)) %>%
group_by(CALIFICACION, IMPORTE) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = IMPORTE, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_bar(stat = 'identity')
ggplotly(p)
colScale <- scale_colour_manual(name = "gor",values = c("green", "orange", "red"))
colScale <- scale_colour_manual(name = "gor",values = c("green", "orange", "red"))
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = Año, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity') +
colScale
ggplotly(p)
?scale_color_manual
colScale <- scale_colour_manual(name = "gor",values = c("green", "orange", "red"))
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = Año, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity') +
scale_fill_manual("legend", values = c("Leve" = "green", "Grave" = "orange", "Muy Grave" = "red"))
ggplotly(p)
library(flexdashboard)
library(readr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(plotly)
library(forcats)
p <- multas %>%
mutate(Año = year(date_time)) %>%
group_by(Año, CALIFICACION) %>%
summarize(`Número de multas` = n()) %>%
ggplot(aes(x = Año, y = `Número de multas`, fill = CALIFICACION)) +
theme_bw() +
theme(legend.title = element_blank()) +
geom_bar(stat = 'identity') +
scale_fill_manual("legend", values = c("Leve" = "#228B22", "Grave" = "orange", "Muy Grave" = "red"))
ggplotly(p)
